<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    #residentialBalance {
      font-weight: bold;
    }
  </style>
  <title>Gestão Residencial</title>
</head>
<body>
  <h1>Gestão Residencial</h1>
  
  <label for="billType">Tipo de Conta:</label>
  <select id="billType">
    <option value="energia">Energia</option>
    <option value="gas">Gás</option>
    <option value="agua">Água</option>
    <option value="contaCgd">Conta CGD</option>
    <option value="limpeza">Limpeza</option>
    <option value="manutencao">Manutenção</option>
    <option value="outros">Outros</option>
  </select>

  <label for="amount">Valor:</label>
  <input type="number" id="amount" step="0.01">

  <button onclick="addBill()">Adicionar Conta</button>

  <hr>

  <label for="apartmentNumber">Número do Apartamento:</label>
  <select id="apartmentNumber">
    <option value="rcDireito">RC Direito</option>
    <option value="rcEsquerdo">RC Esquerdo</option>
    <option value="rcFrente">RC Frente</option>
    <option value="2AndarDireito">2º Andar Direito</option>
    <option value="2AndarFrente">2º Andar Frente</option>
    <option value="2AndarEsquerdo">2º Andar Esquerdo</option>
  </select>

  <label for="membershipFee">Mensalidade (€):</label>
  <input type="number" id="membershipFee" step="0.01">

  <button onclick="addMembership()">Adicionar Mensalidade</button>

  <hr>

  <p>Saldo Total do Residencial: <span id="residentialBalance">0.00</span> €</p>

  <button onclick="generateReport()">Gerar Relatório Mensal</button>
  <button onclick="deleteReport()">Deletar Relatório</button>

  <h2>Relatórios Mensais</h2>
  <ul id="reportList"></ul>

  <script>
    // Database Arrays
    const billsDatabase = Array(100).fill(0);
    const membershipsDatabase = Array(100).fill(0);

    // Reports Array
    let reports = [];

    function addBill() {
      const billType = document.getElementById('billType').value;
      const amount = parseFloat(document.getElementById('amount').value);

      if (!isNaN(amount)) {
        const index = billsDatabase.findIndex(value => value === 0);
        billsDatabase[index] = -amount;
        updateResidentialBalance();
        console.log(`Nova conta adicionada: ${billType} - ${amount} €`);
      }
    }

    function addMembership() {
      const apartmentNumber = document.getElementById('apartmentNumber').value;
      const membershipFee = parseFloat(document.getElementById('membershipFee').value);

      if (!isNaN(membershipFee)) {
        const index = membershipsDatabase.findIndex(value => value === 0);
        membershipsDatabase[index] = membershipFee;
        updateResidentialBalance();
        console.log(`Nova mensalidade adicionada para o apartamento ${apartmentNumber}: ${membershipFee} €`);
      }
    }

    function updateResidentialBalance() {
      const totalBills = billsDatabase.reduce((acc, value) => acc + value, 0);
      const totalMemberships = membershipsDatabase.reduce((acc, value) => acc + value, 0);
      const totalBalance = totalBills + totalMemberships;

      document.getElementById('residentialBalance').textContent = totalBalance.toFixed(2);
    }

    function generateReport() {
      const date = new Date().toLocaleDateString();
      const report = {
        date,
        bills: [...billsDatabase],
        memberships: [...membershipsDatabase],
      };

      reports.push(report);
      saveReportsToLocalStorage();
      displayReports();
      console.log(`Relatório gerado em ${date}`);
    }

    function deleteReport() {
      reports = [];
      saveReportsToLocalStorage();
      displayReports();
      console.log('Relatórios deletados');
    }

    function saveReportsToLocalStorage() {
      localStorage.setItem('residentialReports', JSON.stringify(reports));
    }

    function loadReportsFromLocalStorage() {
      const savedReports = localStorage.getItem('residentialReports');
      if (savedReports) {
        reports = JSON.parse(savedReports);
      }
    }

    function displayReports() {
      const reportList = document.getElementById('reportList');
      reportList.innerHTML = '';

      reports.forEach(report => {
        const listItem = document.createElement('li');
        listItem.textContent = `Relatório em ${report.date}`;
        reportList.appendChild(listItem);
      });
    }

    // Load existing reports on page load
    loadReportsFromLocalStorage();
    displayReports();
  </script>
</body>
</html>
